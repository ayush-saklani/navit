"use client";
import{BrowserMultiFormatReader as f,Exception as c}from"@zxing/library";import{useEffect as m,useRef as u}from"react";import o from"react";function s(e){let n=u(null),i=u(new f);return m(()=>{var d;if(n.current)return i.current.timeBetweenDecodingAttempts=(d=e.scanDelay)!=null?d:500,i.current.decodeFromConstraints({audio:!1,video:{facingMode:e.facingMode||"environment"}},n.current,(r,a)=>{if(r){let l=()=>{try{let t;try{t=JSON.parse(r.getText())}catch(v){return e.validate?e.validate(r.getText()):r.getText()}return e.validate?e.validate(t):t}catch(t){throw t&&t!=null&&t!=null&&typeof t.message=="string"?new c(t.message):new c("Unknown error")}};e.onResult(l(),r)}a&&e.onError!=null&&a.getKind()!=="NotFoundException"&&e.onError(a)}),()=>{i.current.reset()}},[n]),e.children?o.createElement(o.Fragment,null,e.children(n)):o.createElement("div",null,o.createElement("video",{ref:n}))}export{s as QrCodeScanner};
